merge some changes in the source code.
Add some new code to the source code. 
