merge some changes in the source code. 
